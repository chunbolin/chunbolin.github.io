## 为什么要做Cascades

起初我们的DB主要是通过C API进行增删改查等操作的，因此不涉及非常复杂的计划。但是随着业务的发展，我们逐步引入了一些复杂的查询语言，如SQL、Datalog等。由于复杂查询如果不经过优化直接运行，往往性能较差，这就对查询优化提出了要求。

## 为什么选择Cascades

我们也调研了很多其他的优化器实现方式。目前主流的优化器实现方式有如PostgreSQL利用启发式+自底向上的动态规划，也有自顶向下的实现方式，如Volcano和Cascades。

PG的优化器的主要问题在于：（1）规则维护困难，PG优化器的规则是层层嵌套的，比如说用if判断判断是否满足某个条件，如何去做某个转换，这就意味着如果规则很多，代码逻辑会非常复杂，造成维护困难 （2）自底向上自然意味着无法进行剪枝，自底向上进行计算时，当发现上层是个代价很高的计划时，底层其实已经做了无用的计算了 （3）无法尽快获取一个可行的计划，比如我们要求优化器在一定时间内给出一个可行计划，那么自底向上是没法做的，因为它必须迭代到最上层才能获得一个可行的计划。

Volcano和Cascades都是自顶向下的方式
