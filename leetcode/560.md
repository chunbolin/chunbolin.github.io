## 代码

```java
public int subarraySum(int[] nums, int k) {
    int cnt = 0;
    Map<Integer, Integer> map = new HashMap<>();
    int[] preSums = new int[nums.length + 1];
    preSums[0] = 0;
    for (int i = 1; i < nums.length + 1; i++) {
        preSums[i] = preSums[i-1] + nums[i - 1];
    }
    for (int i = 0; i < nums.length + 1; i++) {
        int key = preSums[i] - k;
        if (map.containsKey(key)) {
            cnt = cnt + map.get(key);
        }
        map.put(preSums[i], map.getOrDefault(preSums[i],0) + 1);
    }
    return cnt;
}
```
